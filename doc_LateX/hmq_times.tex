% This file was automatically created from the m-file 
% "m2tex.m" written by USL. 
% The fontencoding in this file is UTF-8. 
%  
% You will need to include the following two packages in 
% your LaTeX-Main-File. 
%  
% \usepackage{color} 
% \usepackage{fancyvrb} 
%  
% It is advised to use the following option for Inputenc 
% \usepackage[utf8]{inputenc} 
%  
  
% definition of matlab colors: 
\definecolor{mblue}{rgb}{0,0,1} 
\definecolor{mgreen}{rgb}{0.13333,0.5451,0.13333} 
\definecolor{mred}{rgb}{0.62745,0.12549,0.94118} 
\definecolor{mgrey}{rgb}{0.5,0.5,0.5} 
\definecolor{mdarkgrey}{rgb}{0.25,0.25,0.25} 
  
\DefineShortVerb[fontfamily=courier,fontseries=m]{\$} 
\DefineShortVerb[fontfamily=courier,fontseries=b]{\#} 
  
\noindent                       
 \hspace*{-1.6em}{\scriptsize 1}$  $\color{mblue}$function$\color{black}$ D = hmq_times(A,B)$\\
 \hspace*{-1.6em}{\scriptsize 2}$  $\color{mgreen}$%Takes 2 3D array as input, seen as a Matrix sequence indexed on Z and$\color{black}$$\\
 \hspace*{-1.6em}{\scriptsize 3}$  $\color{mgreen}$%truncated, stored along the third dimension. $\color{black}$$\\
 \hspace*{-1.6em}{\scriptsize 4}$  $\color{mgreen}$%Compute the matrix convolution$\color{black}$$\\
 \hspace*{-1.6em}{\scriptsize 5}$  $\color{mgreen}$%$\color{black}$$\\
 \hspace*{-1.6em}{\scriptsize 6}$  $\color{mgreen}$% A is a 3D array of size m x n x mA$\color{black}$$\\
 \hspace*{-1.6em}{\scriptsize 7}$  $\color{mgreen}$% B is a 3D array of size n x p x mB$\color{black}$$\\
 \hspace*{-1.6em}{\scriptsize 8}$  $\color{mgreen}$%$\color{black}$$\\
 \hspace*{-1.6em}{\scriptsize 9}$      mA=(size(A,3)-1)/2;$\\
 \hspace*{-2em}{\scriptsize 10}$      mB=(size(B,3)-1)/2;$\\
 \hspace*{-2em}{\scriptsize 11}$      m=max(mB,mA);$\\
 \hspace*{-2em}{\scriptsize 12}$      D=zeros(size(A,1),size(B,2),2*m+1);$\\
 \hspace*{-2em}{\scriptsize 13}$      $\\
 \hspace*{-2em}{\scriptsize 14}$      $\color{mgreen}$%Convolution using tensorprod$\color{black}$$\\
 \hspace*{-2em}{\scriptsize 15}$      $\color{mblue}$for$\color{black}$ k=(-m:m)$\\
 \hspace*{-2em}{\scriptsize 16}$          l1=max(k-mB,-mA);$\\
 \hspace*{-2em}{\scriptsize 17}$          l2=min(k+mB,mA);$\\
 \hspace*{-2em}{\scriptsize 18}$          V=A(:,:,(mA+1+l1):(mA+1+l2));$\\
 \hspace*{-2em}{\scriptsize 19}$          U=B(:,:,(k+mB+1-l1):-1:(k+mB+1-l2));$\\
 \hspace*{-2em}{\scriptsize 20}$          D(:,:,m+1+k)=tensorprod(V,U,[2,3],[1,3]);$\\
 \hspace*{-2em}{\scriptsize 21}$      $\color{mblue}$end$\color{black}$$\\
 \hspace*{-2em}{\scriptsize 22}$  $\\
 \hspace*{-2em}{\scriptsize 23}$  $\color{mblue}$end$\color{black}$$\\ 
  
\UndefineShortVerb{\$} 
\UndefineShortVerb{\#}